{include="header"}
<!--
Copyright (C) 2016 Joe Nilson <joenilson at gmail.com>

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<script type="text/javascript">
    function facturar()
    {
        document.f_facturador.procesar.value = 'TRUE';
        document.f_facturador.submit();
    }
</script>
<div class="container-fluid">
    <form name="f_facturador" class="form" action="{$fsc->url()}" method="post">
        <input type="hidden" name="procesar" value="FALSE"/>
        <div class="row">
            <div class="col-sm-12">
                <div class="page-header">
                    <h1>
                        <i class="fa fa-check-square-o" aria-hidden="true"></i>
                        Facturación masiva
                        <a href="{$fsc->url()}" class="btn btn-xs btn-default" title="Recargar la página">
                            <span class="glyphicon glyphicon-refresh"></span>
                        </a>
                        <span class="btn-group">
                            {loop="$fsc->extensions"}
                            {if="$value->type=='button'"}
                            <a href="index.php?page={$value->from}{$value->params}" class="btn btn-xs btn-default">{$value->text}</a>
                            {/if}
                            {/loop}
                        </span>
                    </h1>
                    <p class="help-block">
                        Elige qué es lo que quieres facturar, cómo y pulsa el botón empezar.
                        Se aprobarán los {#FS_ALBARANES#} seleccionados y se generarán las facturas.
                    </p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-2">
                <div class="form-group">
                    <label class="control-label text-capitalize">Fecha {#FS_PEDIDOS#}:</label>
                    <input type="text" name="fecha_pedido" value="{$fsc->fecha_pedido}" class="form-control datepicker" autocomplete="off" onchange="this.form.submit();"/>
                </div>
                <ul class="list-group">
                    <li class="list-group-item active"><span class="badge">{$fsc->total_pedidos_pendientes()['total']}</span>{#FS_PEDIDOS#} de venta pendientes</li>
                    {loop="$fsc->total_pendientes_venta()['lista']"}
                    <li class="list-group-item">
                        <label class="control-label">
                            <input type="checkbox" name="fecha_albaranes[]" id="fecha_albaran_{$counter}">
                            {$key}
                        </label>
                        <span class="badge">{$value}</span>
                    </li>
                    {/loop}
                </ul>
            </div>
            <div class="col-sm-2">
                <div class="form-group">
                    <label class="control-label text-capitalize">Fecha {#FS_ALBARANES#}:</label>
                    <input type="text" name="fecha_albaran" value="{$fsc->fecha_albaran}" class="form-control datepicker" autocomplete="off" onchange="this.form.submit();"/>
                </div>
                <ul class="list-group">
                    <li class="list-group-item active"><span class="badge">{$fsc->total_pendientes_venta()['total']}</span>{#FS_ALBARANES#} de venta pendientes</li>
                    {loop="$fsc->total_pendientes_venta()['lista']"}
                    <li class="list-group-item">
                        <label class="control-label">
                            <input type="checkbox" name="fecha_albaranes[]" id="fecha_albaran_{$counter}">
                            {$key}
                        </label>
                        <span class="badge">{$value}</span>
                    </li>
                    {/loop}
                </ul>
            </div>
            <div class="col-sm-2">
                <div class="form-group">
                    <label class="control-label text-capitalize">{#FS_SERIE#}:</label>
                    <div class="checkbox">
                        {loop="$fsc->serie->all()"}
                        <label class="control-label">
                            <input type="checkbox" name="serie[]" value="{$value->codserie}" />
                            {$value->descripcion}
                        </label><br/>
                        {/loop}
                    </div>
                </div>
            </div>
            <div class="col-sm-2">
                <div class="form-group">
                    <label class="control-label">Facturar con fecha:</label>
                    <input type="text" name="fecha_facturas" value="{$fsc->fecha_facturas}" class="form-control datepicker" autocomplete="off" onchange="this.form.submit();"/>
                </div>
            </div>
            <div class="col-sm-2">
                <br/>
                <button class="btn btn-sm btn-primary" type="button" onclick="this.disabled=true;">
                    <span class="fa fa-play"></span>&nbsp; Empezar
                </button>
            </div>
        </div>
    </form>
</div>
{include="footer"}
